<div class="row mt-4" id="content-ban-hang">
    <!-- Dữ liệu sẽ được chèn vào đây -->
</div>


<script>
    document.addEventListener('DOMContentLoaded', () => {
        function getTodayDayOfWeek() {
            const days = ['Chủ nhật', 'Thứ 2', 'Thứ 3', 'Thứ 4', 'Thứ 5', 'Thứ 6', 'Thứ 7'];
            const today = new Date();
            return days[today.getDay()]; // Trả về tên ngày trong tuần
        }

        function normalizeDayOfWeek(day) {
            const dayMap = {
                'Chủ Nhật': 'Chủ nhật',
                'Chủ nhật': 'Chủ nhật',
                'Thứ 2': 'Thứ 2',
                'Thứ 3': 'Thứ 3',
                'Thứ 4': 'Thứ 4',
                'Thứ 5': 'Thứ 5',
                'Thứ 6': 'Thứ 6',
                'Thứ 7': 'Thứ 7'
            };
            return dayMap[day] || day;
        }

        function formatDate(dateString) {
            const options = {day: '2-digit', month: '2-digit', year: 'numeric'};
            return new Date(dateString).toLocaleDateString('vi-VN', options);
        }

        async function fetchData() {
            try {
                const response = await fetch('http://localhost:8080/san-ca/hien-thi');
                if (!response.ok) {
                    throw new Error(`HTTP error! Status: ${response.status}`);
                }
                const data = await response.json();

                const container = document.getElementById('content-ban-hang');
                container.innerHTML = '';

                if (!Array.isArray(data) || data.length === 0) {
                    container.innerHTML = '<p>Không có dữ liệu để hiển thị.</p>';
                    return;
                }

                const todayDay = getTodayDayOfWeek();
                console.log('Ngày hiện tại trong tuần:', todayDay);

                let dataDisplayed = false; // Flag để theo dõi có dữ liệu được hiển thị không

                data.forEach(item => {
                    const normalizedDay = normalizeDayOfWeek(item.thuTrongTuan);
                    console.log('Ngày trong tuần từ dữ liệu:', normalizedDay);
                    if (normalizedDay === todayDay) {
                        dataDisplayed = true;

                        const col = document.createElement('div');
                        col.className = 'col';

                        const h3 = document.createElement('h3');
                        h3.textContent = item.tenLoaiSan;
                        col.appendChild(h3);

                        const box = document.createElement('div');
                        box.className = 'box';

                        const dateItem = document.createElement('div');
                        dateItem.className = 'box-item';
                        dateItem.innerHTML = `<div class="box-title">Ngày</div><div class="box-content">${formatDate(item.thuTrongTuan)}</div>`;
                        box.appendChild(dateItem);

                        const timeItem = document.createElement('div');
                        timeItem.className = 'box-item';
                        timeItem.innerHTML = `<div class="box-title">Giờ</div><div class="box-content">${item.thoiGianBatDauCa} - ${item.thoiGianKetThucCa}</div>`;
                        box.appendChild(timeItem);

                        const priceItem = document.createElement('div');
                        priceItem.className = 'box-item';
                        priceItem.innerHTML = `<div class="box-title">Tiền</div><div class="box-content">${item.gia} VNĐ</div>`;
                        box.appendChild(priceItem);

                        const statusItem = document.createElement('div');
                        statusItem.className = 'box-item';
                        statusItem.innerHTML = `<div class="box-title">Trạng thái</div><div class="box-content">${item.trangThai}</div>`;
                        box.appendChild(statusItem);

                        col.appendChild(box);
                        container.appendChild(col);
                    }
                });

                if (!dataDisplayed) {
                    container.innerHTML = '<p>Không có dữ liệu cho ngày hiện tại.</p>';
                }
            } catch (error) {
                console.error('Lỗi khi lấy dữ liệu:', error);
                const container = document.getElementById('content-ban-hang');
                container.innerHTML = '<p>Đã xảy ra lỗi khi lấy dữ liệu.</p>';
            }
        }

        fetchData();
    });

</script>
