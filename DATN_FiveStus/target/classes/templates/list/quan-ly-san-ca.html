<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head th:include="fragment/head :: head"></head>
<body class="vertical light">
<div class="wrapper">
    <div th:include="fragment/navbar :: navbar"></div>
    <div th:include="fragment/sidebar :: sidebar"></div>
    <main role="main" class="main-content">
        <div class="container-fluid">
            <div class="row justify-content-center">
                <div class="col-12">
                    <h2 class="mb-2 page-title">Quản lý sân ca</h2>
                    <div class="row my-4">
                        <div class="col-md-12">
                            <div class="card shadow">
                                <div class="card-body">
                                    <div class="toolbar row mb-3">
                                        <div class="col ml-auto">
                                            <div class="dropdown float-right">
                                                <button type="button" class="btn btn-primary float-right ml-3"
                                                        data-toggle="modal" data-target="#varyModal"
                                                        data-whatever="@mdo">Thêm<span class="fe fe-plus "></span>
                                                </button>
                                                <div class="modal fade" id="varyModal" tabindex="-1" role="dialog"
                                                     aria-labelledby="varyModalLabel" aria-hidden="true">
                                                    <div class="modal-dialog" role="document">
                                                        <div class="modal-content">
                                                            <div class="modal-header">
                                                                <h5 class="modal-title" id="varyModalLabel">
                                                                    Thêm sân ca</h5>
                                                                <button type="button" class="close" data-dismiss="modal"
                                                                        aria-label="Close">
                                                                    <span aria-hidden="true">&times;</span>
                                                                </button>
                                                            </div>
                                                            <div class="modal-body">
                                                                <form th:action="@{/sanCa/add}" th:object="${sanCa}" th:method="post">
                                                                    <input type="hidden" th:field="*{id}" id="addId">
                                                                    <div class="form-row">
                                                                        <div class="form-group col-md-6">
                                                                            <label for="addCa">Ca</label>
                                                                            <select id="addCa" class="form-control" th:field="*{idCa}">
                                                                                <option th:each="a : ${listC}" th:value="${a.id}" th:text="${a.tenCa}"></option>
                                                                            </select>
                                                                        </div>
                                                                    </div>
                                                                    <div class="form-row">
                                                                        <div class="form-group col-md-6">
                                                                            <label for="addSanBong">Sân bóng</label>
                                                                            <select id="addSanBong" class="form-control" th:field="*{idSanBong}">
                                                                                <option th:each="b : ${listSB}" th:value="${b.id}" th:text="${b.tenSanBong}"></option>
                                                                            </select>
                                                                        </div>
                                                                    </div>
                                                                    <div class="form-row">
                                                                        <div class="form-group col-md-6">
                                                                            <label for="addNgayTrongTuan">ngayTrongTuan</label>
                                                                            <select id="addNgayTrongTuan" class="form-control" th:field="*{idNgayTrongTuan}">
                                                                                <option th:each="c : ${listNTT}" th:value="${c.id}" th:text="${c.thuTrongTuan}"></option>
                                                                            </select>
                                                                        </div>
                                                                    </div>
                                                                    <div class="form-row">
                                                                        <div class="form-group col-md-6">
                                                                            <label for="addTrangThai">trangThai</label>
                                                                            <select id="addTrangThai" class="form-control" th:field="*{trangThai}">
                                                                                <option th:each="d : ${listSC}" th:value="${d.trangThai}" th:text="${d.trangThai}"></option>
                                                                            </select>
                                                                        </div>
                                                                    </div>
                                                                    <div class="form-row">
                                                                        <label for="addGia">Gia</label>
                                                                        <input type="text" class="form-control" th:field="*{gia}" id="addGia">
                                                                    </div>
                                                                    <div class="modal-footer">
                                                                        <button type="button" class="btn mb-2 btn-secondary" data-dismiss="modal">Close</button>
                                                                        <button type="submit" class="btn mb-2 btn-primary">ADD</button>
                                                                    </div>
                                                                </form>

                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <button class="btn btn-secondary dropdown-toggle" type="button"
                                                        id="actionMenuButton" data-toggle="dropdown"
                                                        aria-haspopup="true" aria-expanded="false"> Hành động
                                                </button>
                                                <div class="dropdown-menu" aria-labelledby="actionMenuButton">
                                                    <a class="dropdown-item" href="#">Export</a>
                                                    <a class="dropdown-item" href="#">Something else here</a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <table class="table">
                                        <thead>
                                        <tr>
                                            <th>STT</th>
                                            <th>tenCa</th>
                                            <th>tenSanBong</th>
                                            <th>thuTrongTuan</th>
                                            <th>trangThai</th>
                                            <th>gia</th>
                                            <th>Hành động</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        <tr th:each="a, b : ${listSC}">
                                            <td th:text="${b.count}"></td>
                                            <td th:text="${a.tenCa}"></td>
                                            <td th:text="${a.tenSanBong}"></td>
                                            <td th:text="${a.thuTrongTuan}"></td>
                                            <td th:text="${a.trangThai}"></td>
                                            <td th:text="${a.gia}"></td>
                                            <td>
                                                <button type="button" class="btn btn-success edit-btn" data-toggle="modal" data-target="#editModal" th:attr="data-id=${a.id}">Edit</button>
                                            </td>
                                        </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div th:include="fragment/modal :: modal"></div>
    </main>
</div>

<!-- Modal Edit -->
<div class="modal fade" id="editModal" tabindex="-1" role="dialog" aria-labelledby="editModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="editModalLabel">Chỉnh sửa sân ca</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form th:action="@{/sanCa/update}" th:object="${sanCa}" th:method="post">
                    <input type="hidden" th:field="*{id}" id="editId">
                    <div class="form-row">
                        <div class="form-group col-md-6">
                            <label for="editCa">Ca</label>
                            <select id="editCa" class="form-control" th:field="*{idCa}">
                                <option th:each="a : ${listC}" th:value="${a.id}" th:text="${a.tenCa}"></option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group col-md-6">
                            <label for="editSanBong">Sân bóng</label>
                            <select id="editSanBong" class="form-control" th:field="*{idSanBong}">
                                <option th:each="b : ${listSB}" th:value="${b.id}" th:text="${b.tenSanBong}"></option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group col-md-6">
                            <label for="editNgayTrongTuan">ngayTrongTuan</label>
                            <select id="editNgayTrongTuan" class="form-control" th:field="*{idNgayTrongTuan}">
                                <option th:each="c : ${listNTT}" th:value="${c.id}" th:text="${c.thuTrongTuan}"></option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group col-md-6">
                            <label for="editTrangThai">trangThai</label>
                            <select id="editTrangThai" class="form-control" th:field="*{trangThai}">
                                <option th:each="d : ${listSC}" th:value="${d.trangThai}" th:text="${d.trangThai}"></option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <label for="editGia">Gia</label>
                        <input type="text" class="form-control" th:field="*{gia}" id="editGia">
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn mb-2 btn-secondary" data-dismiss="modal">Close</button>
                        <button type="submit" class="btn mb-2 btn-primary">UPDATE</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- JavaScript -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
    $(document).ready(function() {
        $('.edit-btn').on('click', function() {
            var id = $(this).data('id');
            $.ajax({
                url: '/sanCa/edit/' + id,
                method: 'GET',
                success: function(data) {
                    $('#editId').val(data.id);
                    $('#editCa').val(data.idCa);
                    $('#editSanBong').val(data.idSanBong);
                    $('#editNgayTrongTuan').val(data.idNgayTrongTuan);
                    $('#editTrangThai').val(data.trangThai);
                    $('#editGia').val( parseFloat(data.gia));
                }
            });
        });
    });
</script>
</body>
<div th:include="fragment/script :: script"></div>
</html>
